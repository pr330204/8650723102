<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vega Streaming - FIXED</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
    <style>
        /* Same CSS as before - copy from previous code */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #000 0%, #1a1a2e 50%, #16213e 100%);
            color: white; 
            min-height: 100vh;
        }
        /* ... rest of CSS same as previous ... */
        .status { text-align: center; padding: 2rem; color: #ff6b6b; }
        .success { color: #10b981 !important; }
    </style>
</head>
<body>
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <h1>üîÑ Loading Vega Streams...</h1>
        <div id="status" class="status">Fetching JSON data...</div>
    </div>

    <!-- Hero + Grid + Player same as before -->
    <section class="hero" style="display:none;">
        <!-- Same hero code -->
    </section>
    <section id="moviesGrid" class="movies-grid" style="display:none;"></section>
    <div id="playerModal" class="player-modal" style="display:none;">
        <!-- Same player code -->
    </div>

    <script>
        let allMovies = [];
        let filteredMovies = [];

        // ‚úÖ CORS PROXY + Backup URLs
        const VEGA_URLS = [
            'https://api.allorigins.win/raw?url=https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/index.json',
            'https://corsproxy.io/?https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/index.json',
            'https://api.allorigins.win/get?url=https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/index.json'
        ];

        async function fetchMovies() {
            const statusEl = document.getElementById('status');
            
            for (let i = 0; i < VEGA_URLS.length; i++) {
                try {
                    statusEl.textContent = `Trying proxy ${i + 1}/3...`;
                    statusEl.className = 'status';
                    
                    const response = await fetch(VEGA_URLS[i], { 
                        mode: 'cors',
                        cache: 'no-cache'
                    });
                    
                    if (!response.ok) throw new Error('HTTP ' + response.status);
                    
                    let data;
                    if (VEGA_URLS[i].includes('allorigins.win/get')) {
                        const json = await response.json();
                        data = JSON.parse(json.contents);
                    } else {
                        data = await response.json();
                    }
                    
                    // Process movies
                    allMovies = Object.entries(data).slice(0, 50).map(([title, info]: [string, any]) => ({
                        id: title.replace(/[^a-zA-Z0-9]/g, '_'),
                        title: title,
                        poster: info.poster || `https://via.placeholder.com/300x450/333/999?text=${encodeURIComponent(title.substring(0,10))}`,
                        hls: info.hls || [],
                        mp4: info.mp4 || [],
                        description: info.description || `${title} - HD Stream Ready`
                    }));

                    filteredMovies = [...allMovies];
                    
                    if (allMovies.length > 0) {
                        statusEl.textContent = `‚úÖ Loaded ${allMovies.length} movies!`;
                        statusEl.className = 'status success';
                        renderMovies();
                        setTimeout(showContent, 1000);
                        return;
                    }
                } catch (error) {
                    console.error(`Proxy ${i + 1} failed:`, error);
                    statusEl.textContent = `Proxy ${i + 1} failed, trying next...`;
                }
            }
            
            // Final fallback
            statusEl.innerHTML = `
                ‚ùå All proxies failed!<br>
                <small>Try: <a href="https://codepen.io/pen/" style="color:#3b82f6;" target="_blank">CodePen</a> or 
                <a href="https://replit.com" style="color:#3b82f6;" target="_blank">Replit</a></small>
            `;
        }

        // Rest of functions same as before...
        function renderMovies() {
            const grid = document.getElementById('moviesGrid');
            grid.innerHTML = filteredMovies.map(movie => `
                <div class="movie-card" onclick="playMovie('${movie.id}')">
                    <div style="position: relative;">
                        <img src="${movie.poster}" alt="${movie.title}" class="movie-poster" 
                             onerror="this.src='https://via.placeholder.com/300x450/1a1a1a/888?text=No+Poster'">
                        <div class="play-overlay">
                            <div class="play-btn">‚ñ∂</div>
                        </div>
                    </div>
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                    </div>
                </div>
            `).join('');
        }

        function playMovie(movieId) {
            const movie = allMovies.find(m => m.id === movieId);
            if (!movie) return;

            document.getElementById('movieTitle').textContent = movie.title;
            document.getElementById('movieDesc').textContent = movie.description;

            const video = document.getElementById('videoPlayer');
            const streamUrl = movie.hls[0] || movie.mp4[0];
            
            if (!streamUrl) {
                alert('No stream available');
                return;
            }

            // Use CORS proxy for streams too
            const proxyStream = streamUrl.replace('https://raw.githubusercontent.com', 'https://api.allorigins.win/raw?url=');
            
            if (Hls.isSupported() && streamUrl.includes('.m3u8')) {
                const hls = new Hls();
                hls.loadSource(streamUrl);
                hls.attachMedia(video);
            } else {
                video.src = streamUrl;
            }

            video.play().catch(e => {
                console.error('Play error:', e);
                video.src = proxyStream;
                video.play();
            });
            
            document.getElementById('playerModal').style.display = 'flex';
        }

        function closePlayer() {
            const video = document.getElementById('videoPlayer');
            if (video.hls) video.hls.destroy();
            video.pause();
            video.src = '';
            document.getElementById('playerModal').style.display = 'none';
        }

        function showContent() {
            document.getElementById('loading').style.display = 'none';
            document.querySelector('.hero').style.display = 'flex';
            document.getElementById('moviesGrid').style.display = 'grid';
        }

        // Search + other code same...
        document.addEventListener('DOMContentLoaded', () => {
            // Add missing CSS classes
            const style = document.createElement('style');
            style.textContent = `
                .loading { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 2rem; }
                .spinner { width: 60px; height: 60px; border: 4px solid rgba(255,255,255,0.2); border-top: 4px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; }
                @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                .hero, .movies-grid, .player-modal { /* paste full CSS from previous message */ }
            `;
            document.head.appendChild(style);
            
            fetchMovies();
        });
    </script>
</body>
</html>ÔøºEnterYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vega Streaming - FIXED</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
    <style>
        
        /* Same CSS as before - copy from previou
        *        *:  ; rgin: 0: p; ding: 0; b: -sizing: b; d
        
      
                     fo: -family: ', goe UI', s; 
                     b: kground: linear-gradie, #000 eg, #1a1a2e  #1, #16213e  #162;
                 :   col; 
                     m: -heig;
        

        
        /* ... rest of CSS same as previo
        .         status { t: t-alig;  center: padd; g: 2r: #ff6b6b; #
        .        . ucces: #10b981  #10b981 !; p
    </style>
</head>
<body>
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <h1>üîÑ Loading Vega Streams...</h1>
        <div id="status" class="status">Fetching JSON data...</div>
    </div>

    <!-- Hero + Grid + Player same as before -->
    <section class="hero" style="" style="dis;">
        <!-- Same hero code -->
    </section>
    <section id="moviesGrid" class="movies-grid" style="" style="dis;"></section>
    <div id="playerModal" class="player-modal" style="" style="dis;">
        <!-- Same player code -->
    </div>

    <script>
        
        let  = Mo;
        
        let filte = Mo;

        
        // ‚úÖ CORS PROXY + Ba
        
        const  = A
                     'https://api.allorigins.win/raw?url=https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/in,
                     'https://corsproxy.io/?https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/in,
            'https://api.allorigins.win/get?url=https://raw.githubusercontent.com/vega-org/vega-providers/main/providers/index.json'
        ];

        async function fetchMovies() {
            const statusEl = document.getElementById('status');
            
            for (let i = 0; i < VEGA_URLS.length; i++) {
                try {
                    statusEl.textContent = `Trying proxy ${i + 1}/3...`;
                    statusEl.className = 'status';
                    
                    const response = await fetch(VEGA_URLS[i], { 
                        mode: 'cors',
                        cache: 'no-cache'
                    });
                    
                    if (!response.ok) throw new Error('HTTP ' + response.status);
                    
                    let data;
                    if (VEGA_URLS[i].includes('allorigins.win/get')) {
                        const json = await response.json();
                        data = JSON.parse(json.contents);
                    } else {
                        data = await response.json();
                    }
                    
                    // Process movies
                    allMovies = Object.entries(data).slice(0, 50).map(([title, info]: [string, any]) => ({
                        id: title.replace(/[^a-zA-Z0-9]/g, '_'),
                        title: title,
                        poster: info.poster || `https://via.placeholder.com/300x450/333/999?text=${encodeURIComponent(title.substring(0,10))}`,
                        hls: info.hls || [],
                        mp4: info.mp4 || [],
                        description: info.description || `${title} - HD Stream Ready`
                    }));

                    filteredMovies = [...allMovies];
                    

